<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OP-XY Multisample Converter</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>OP-XY Multisample Converter</h1>
            <p class="subtitle">Convert multisamples to OP-XY format with automatic silence trimming</p>
        </header>

        <main>
            <div class="mode-selector">
                <h2>Choose Conversion Mode</h2>
                <div class="mode-buttons">
                    <button id="elektron-mode-btn" class="mode-btn active" onclick="switchMode('elektron')">
                        <strong>Elektron Mode</strong>
                        <span>.elmulti + .wav files</span>
                    </button>
                    <button id="folder-mode-btn" class="mode-btn" onclick="switchMode('folder')">
                        <strong>Folder Mode</strong>
                        <span>Individual WAV files</span>
                    </button>
                </div>
            </div>

            <!-- Elektron Mode -->
            <div id="elektron-mode" class="mode-panel active">
                <h3>Elektron Mode</h3>
                <p>Upload an Elektron .elmulti file and its corresponding .wav file</p>

                <div class="file-input-group">
                    <label for="elmulti-file">
                        <strong>.elmulti file:</strong>
                        <input type="file" id="elmulti-file" accept=".elmulti" onchange="handleElmultiFile(event)">
                    </label>
                    <span id="elmulti-filename" class="filename"></span>
                </div>

                <div class="file-input-group">
                    <label for="wav-file">
                        <strong>.wav file:</strong>
                        <input type="file" id="wav-file" accept=".wav" onchange="handleWavFile(event)">
                    </label>
                    <span id="wav-filename" class="filename"></span>
                </div>

                <button id="convert-elektron-btn" class="convert-btn" onclick="convertElektron()" disabled>
                    Convert to OP-XY Format
                </button>
            </div>

            <!-- Folder Mode -->
            <div id="folder-mode" class="mode-panel">
                <h3>Folder Mode</h3>
                <p>Upload multiple WAV files with note names in filenames (e.g., "Piano C3.wav")</p>

                <div class="file-input-group">
                    <label for="preset-name">
                        <strong>Preset Name:</strong>
                        <input type="text" id="preset-name" placeholder="MyPreset" onchange="updateConvertButton()">
                    </label>
                </div>

                <div class="file-input-group">
                    <label for="wav-files">
                        <strong>Select WAV files:</strong>
                        <input type="file" id="wav-files" accept=".wav" multiple onchange="handleWavFiles(event)">
                    </label>
                    <span id="wav-files-count" class="filename"></span>
                </div>

                <button id="convert-folder-btn" class="convert-btn" onclick="convertFolder()" disabled>
                    Convert to OP-XY Format
                </button>
            </div>

            <!-- Progress and Log -->
            <div id="progress-section" class="hidden">
                <h3>Processing...</h3>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <div id="log-output" class="log-output"></div>
            </div>

            <!-- Download Section -->
            <div id="download-section" class="hidden">
                <h3>âœ“ Conversion Complete!</h3>
                <p>Your preset is ready to download</p>
                <button id="download-btn" class="download-btn" onclick="downloadPreset()">
                    Download .preset folder (ZIP)
                </button>
                <p class="instruction">Extract the ZIP and copy the .preset folder to /TAPE/multisamples/ on your OP-XY</p>
            </div>
        </main>

        <footer>
            <details>
                <summary>File Naming Guide for Folder Mode</summary>
                <div class="info-box">
                    <p><strong>Supported formats:</strong></p>
                    <ul>
                        <li><code>Piano C3.wav</code></li>
                        <li><code>C3.wav</code></li>
                        <li><code>piano_C#3.wav</code></li>
                        <li><code>Bass_Db3.wav</code></li>
                        <li><code>SampleName D-1.wav</code> (negative octaves supported)</li>
                    </ul>
                    <p>The tool extracts note names from filenames and creates proper key mappings.</p>
                </div>
            </details>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="converter.js"></script>
</body>
</html>
